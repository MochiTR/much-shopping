"use strict";(self["webpackChunktest"]=self["webpackChunktest"]||[]).push([[33],{1033:function(t,e,s){s.r(e),s.d(e,{default:function(){return dt}});var a=s(3396),l=s(9242),o=s(7139);const i={class:"container text-white pb-5",style:{"margin-top":"56px"}},r={class:"row row-cols-1 justify-content-center h-100",style:{"min-height":"100vh"}},n={key:0,class:"col"},d={class:"overflow-auto"},c={class:"table mt-4 text-white text-nowrap"},u=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"200"}),(0,a._)("th",{width:"240"},"品名"),(0,a._)("th",{width:"150"},"數量"),(0,a._)("th",{width:"150"},"單價"),(0,a._)("th",null,"備註"),(0,a._)("th")])],-1),m=["src"],p=["onClick"],h={class:"text-right"},g={class:"input-group input-group-sm"},_=["onUpdate:modelValue","onChange","disabled"],b={class:"input-group-text"},f=(0,a._)("td",null,[(0,a._)("textarea",{class:"form-control",placeholder:"輸入備註",id:"floatingTextarea2",style:{height:"150px",resize:"none"}})],-1),v=["onClick"],y=(0,a._)("i",{class:"bi bi-trash3-fill"},null,-1),C=[y],w={class:"text-start"},x={class:"text-end"},k=(0,a._)("hr",null,null,-1),$={class:"input-group"},V=(0,a._)("hr",null,null,-1),M={class:"input-group"},F=(0,a._)("input",{class:"form-control",value:"總計：",disabled:""},null,-1),W=["value"],U={key:1,class:"col text-center mt-5"},q=(0,a._)("h2",null,"購物車目前沒有商品",-1),D=(0,a._)("span",{class:"display-5"},"將商品加入購物車吧！",-1),j=(0,a._)("i",{class:"bi bi-three-dots"},null,-1),z=(0,a._)("i",{class:"bi bi-cart3"},null,-1),E=[D,j,z];function I(t,e,s,y,D,j){const z=(0,a.up)("LoadingAnimation"),I=(0,a.up)("orderFormModal");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(z,{active:D.loading},null,8,["active"]),(0,a._)("div",r,[D.cart.carts?((0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",d,[(0,a._)("table",c,[u,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(D.cart.carts,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,[(0,a._)("img",{class:"img-fluid",src:e.product.imageUrl,style:{height:"150px",width:"200px","object-fit":"cover","object-position":"center"}},null,8,m)]),(0,a._)("td",null,[(0,a._)("a",{href:"#",onClick:(0,l.iM)((t=>j.getProduct(e.product_id)),["prevent"])},(0,o.zw)(e.product.title),9,p)]),(0,a._)("td",h,[(0,a._)("div",g,[(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":t=>e.qty=t,onChange:t=>j.updateCart(e),disabled:this.status.loadingItem===e.id},null,40,_),[[l.nr,e.qty,void 0,{number:!0}]]),(0,a._)("div",b,"/ "+(0,o.zw)(e.product.unit),1)])]),(0,a._)("td",null,(0,o.zw)(t.$filters.currency(e.final_total)),1),f,(0,a._)("td",null,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger",onClick:(0,l.iM)((t=>j.deleteCart(e)),["prevent"])},C,8,v)])])))),128))])])]),(0,a._)("div",w,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e[0]||(e[0]=(...t)=>j.clearCart&&j.clearCart(...t))},"清空購物車")]),(0,a._)("div",x," 總計："+(0,o.zw)(t.$filters.currency(D.cart.final_total)),1),k,(0,a._)("div",$,[(0,a.wy)((0,a._)("input",{class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>D.couponCode=t)},null,512),[[l.nr,D.couponCode]]),(0,a._)("button",{class:"input-group-text btn btn-outline-secondary",onClick:e[2]||(e[2]=(...t)=>j.useCoupon&&j.useCoupon(...t))},"使用優惠券")]),V,(0,a._)("div",M,[F,(0,a._)("input",{class:"form-control w-25",style:{"border-left":"0px"},value:t.$filters.currency(D.cart.final_total),disabled:""},null,8,W),(0,a._)("button",{class:"input-group-text btn btn-outline-primary w-50 w-lg-75",onClick:e[3]||(e[3]=(...t)=>j.openForm&&j.openForm(...t))},"結帳")])])):((0,a.wg)(),(0,a.iD)("div",U,[q,(0,a._)("p",{class:"display-1",onClick:e[4]||(e[4]=(...t)=>j.toHome&&j.toHome(...t)),style:{cursor:"pointer"}},E)]))]),(0,a.Wm)(I,{ref:"OrderModal",onEmitForm:j.createOrder},null,8,["onEmitForm"])])}const O={class:"modal fade text-dark",tabindex:"-1",ref:"modal"},P={class:"modal-dialog modal-xl"},H={class:"modal-content"},S=(0,a._)("div",{class:"modal-header"},[(0,a._)("h5",{class:"modal-title"},"建立訂單"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),T={class:"modal-body"},Z={class:"mt-5 row justify-content-center"},A={class:"mb-3"},K=(0,a._)("label",{for:"email",class:"form-label"},"Email",-1),L={class:"mb-3"},Y=(0,a._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),B={class:"mb-3"},G=(0,a._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),J={class:"mb-3"},N=(0,a._)("label",{for:"address",class:"form-label"},"收件人地址",-1),Q={class:"mb-3"},R=(0,a._)("label",{for:"message",class:"form-label"},"留言",-1),X=(0,a._)("div",{class:"text-end"},[(0,a._)("button",{type:"button",class:"btn btn-secondary me-3","data-bs-dismiss":"modal"},"關閉"),(0,a._)("button",{class:"btn btn-danger"},"送出訂單")],-1);function tt(t,e,s,i,r,n){const d=(0,a.up)("V-Field"),c=(0,a.up)("ErrorMessage"),u=(0,a.up)("V-Form");return(0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("div",P,[(0,a._)("div",H,[S,(0,a._)("div",T,[(0,a._)("div",Z,[(0,a.Wm)(u,{class:"col-md-8",onSubmit:n.sendFormData},{default:(0,a.w5)((({errors:t})=>[(0,a._)("div",A,[K,(0,a.Wm)(d,{id:"email",name:"email",type:"email",class:(0,o.C_)(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:r.form.user.email,"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.user.email=t)},null,8,["class","modelValue"]),(0,a.Wm)(c,{name:"email",class:"invalid-feedback"})]),(0,a._)("div",L,[Y,(0,a.Wm)(d,{id:"name",name:"姓名",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:r.form.user.name,"onUpdate:modelValue":e[1]||(e[1]=t=>r.form.user.name=t)},null,8,["class","modelValue"]),(0,a.Wm)(c,{name:"姓名",class:"invalid-feedback"})]),(0,a._)("div",B,[G,(0,a.Wm)(d,{id:"tel",name:"電話",type:"tel",class:(0,o.C_)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:r.form.user.tel,"onUpdate:modelValue":e[2]||(e[2]=t=>r.form.user.tel=t)},null,8,["class","modelValue"]),(0,a.Wm)(c,{name:"電話",class:"invalid-feedback"})]),(0,a._)("div",J,[N,(0,a.Wm)(d,{id:"address",name:"地址",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:r.form.user.address,"onUpdate:modelValue":e[3]||(e[3]=t=>r.form.user.address=t)},null,8,["class","modelValue"]),(0,a.Wm)(c,{name:"地址",class:"invalid-feedback"})]),(0,a._)("div",Q,[R,(0,a.wy)((0,a._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[4]||(e[4]=t=>r.form.message=t)},null,512),[[l.nr,r.form.message]])]),X])),_:1},8,["onSubmit"])])])])])],512)}var et=s(7972),st=s.n(et),at={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{showModal(){this.modal.show()},closeModal(){this.modal.hide()},sendFormData(){this.$emit("emit-form",this.form)}},mounted(){this.modal=new(st())(this.$refs.modal)}},lt=s(89);const ot=(0,lt.Z)(at,[["render",tt]]);var it=ot,rt={data(){return{products:[],tempProduct:{},loading:!1,status:{loagindItem:""},cart:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},couponCode:""}},components:{orderFormModal:it},inject:["emitter"],methods:{getProductions(){this.loading=!0;const t="https://vue3-course-api.hexschool.io/api/much-shopping-api/products/all";this.$http.get(t).then((t=>{this.loading=!1,t.data.success&&(this.products=t.data.products)}))},getProduct(t){this.$router.push(`/product/${t}`)},getCart(){this.loading=!0;const t="https://vue3-course-api.hexschool.io/api/much-shopping-api/cart";this.$http.get(t).then((t=>{this.loading=!1,this.cart=t.data.data,console.log(this.cart.carts),0===this.cart.carts.length&&(this.cart.carts=0)}))},updateCart(t){this.loading=!0,this.status.loadingItem=t.id;const e=`https://vue3-course-api.hexschool.io/api/much-shopping-api/cart/${t.id}`,s={product_id:t.product_id,qty:t.qty};this.$http.put(e,{data:s}).then((t=>{this.loading=!1,this.status.loadingItem="",this.getCart()}))},deleteCart(t){const e=`https://vue3-course-api.hexschool.io/api/much-shopping-api/cart/${t.id}`;this.$http.delete(e).then((t=>{t.data.success&&(this.emitter.emit("push-message",{style:"success",title:"已移除購物車內商品"}),this.getCart())}))},clearCart(){const t="https://vue3-course-api.hexschool.io/api/much-shopping-api/carts";this.$http.delete(t).then((t=>{t.data.success&&(this.emitter.emit("push-message",{style:"success",title:"購物車已清空"}),this.getCart())}))},useCoupon(){const t="https://vue3-course-api.hexschool.io/api/much-shopping-api/coupon",e={code:this.couponCode};this.$http.post(t,{data:e}).then((t=>{this.getCart(),console.log(this.couponCode)}))},openForm(){this.$refs.OrderModal.showModal()},createOrder(t){const e="https://vue3-course-api.hexschool.io/api/much-shopping-api/order";this.$http.post(e,{data:t}).then((t=>{console.log(t),t.data.success?(this.emitter.emit("push-message",{style:"success",title:"已建立訂單"}),this.clearCart(),this.$refs.OrderModal.closeModal(),this.$router.push(`/checkout/${t.data.orderId}`)):this.emitter.emit("push-message",{style:"danger",title:"已建立訂單",content:t.data.message})}))},toHome(){this.$router.push("/")}},created(){this.getProductions(),this.getCart(),window.scrollTo(0,0)}};const nt=(0,lt.Z)(rt,[["render",I]]);var dt=nt}}]);
//# sourceMappingURL=33.cae242ff.js.map